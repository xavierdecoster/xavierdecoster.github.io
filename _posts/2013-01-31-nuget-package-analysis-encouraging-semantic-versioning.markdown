---
layout: single
title: "NuGet Package Analysis: Encouraging Semantic Versioning"
date: 2013-01-31 00:00:00 +0100
comments: true
published: true
categories: ["post"]
tags: ["NuGet","SemVer","Package Management"]
alias: ["/2013/01/31/nuget-package-analysis-encouraging-semantic-versioning/"]
author: Xavier Decoster
redirect_from:
 - /2013/01/31/nuget-package-analysis-encouraging-semantic-versioning/.html
 - /nuget-package-analysis-encouraging-semantic-versioning
---
<p><p>If you've been in one of my recent talks or follow my blog or Twitter ramblings, you might have noticed I'm quite a fan of adhering to the <a href="http://semver.org">Semantic Versioning</a> specification. I find it particularly useful as a means to communicate changes in your API towards your package consumers who in turn will be able to set proper expectations about what they'll get when updating a certain package. It also enables NuGet to be smarter about package updates (e.g. Update-Package <a href="http://docs.nuget.org/docs/reference/package-manager-console-powershell-reference">–Safe</a>). So in short, I don't see any reason to deviate from SemVer.
</p><p>However, not everyone knows about SemVer and definitely not all of us are applying the SemVer scheme to the packages they produce. Simply take a look at the <a href="http://www.nuget.org">NuGet Gallery</a> and look for a package that has a non-SemVer version, it will take you less than a page scroll to find one (e.g. a version in the MSDN format <a href="http://msdn.microsoft.com/en-us/library/51ket42z.aspx">major.minor.build.revision</a>).
</p><p>There are two major impediments at the moment when it comes to SemVer and NuGet:
</p><ul><li>Not everyone applies SemVer to their packages
</li><li>NuGet doesn't (yet) fully support the SemVer specification
</li></ul><h1>Not everyone produces SemVer packages
</h1><p>I recently noticed this tweet from Steve Bohlen:
</p><blockquote class="twitter-tweet"><p>posited: the fact that <a href="https://twitter.com/search/%23nuget">#nuget</a> tooling respects <a href="https://twitter.com/search/%23semver">#semver</a> but many pkg authors do not is a continued threat to its efficacy and success</p>&mdash; Steve Bohlen (@sbohlen) <a href="https://twitter.com/sbohlen/status/294453663987027968">January 24, 2013</a>

</blockquote>


<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><p>
 </p><p>I agree with the statement in the sense that different versioning schemes on the same repository can cause trouble and are an impediment. The NuGet Gallery is a single public repository, currently hosting a mix of packages with different versioning schemes. It's really hard to support both SemVer and legacy schemes and come up with a generic algorithm to define version precedence! Just take a look at this <a href="https://github.com/mojombo/semver/issues/51">discussion on GitHub</a> (home of the SemVer spec).
</p><p>Only package producers can control what type of versioning they'll use, but in my opinion it is up to the repository owner to validate packages before accepting them on the repository. That's why I built an extension that hooks into the NuGet commandline, which does have package validation logic applied during package creation. You can find it on my GitHub repository (check the readme for details): <a href="https://github.com/xavierdecoster/NuGet.PackageAnalysis">https://github.com/xavierdecoster/NuGet.PackageAnalysis</a>. For now it will only throw warnings (this is a limitation by the current version of the NuGet CLI which treats errors as warnings), but your build log should show something similar to this when violating SemVer:
</p><p><a href="https://github.com/xavierdecoster/NuGet.PackageAnalysis"><img src="/get/013113_1144_NuGetPackag1_634952294442925653.png" style="max-width:750px;" alt="" border="0"/></a>
    </p><p>Don't be surprised to see this feature pop-up in a next version of <a href="http://www.myget.org/">MyGet</a> as a feed-setting.
</p><h1>NuGet &amp; SemVer are not aligned
</h1><p>I know this is on the roadmap and I'm sure it will get priority once the SemVer specification hits RTM (it's an RC at the moment). But until then, try to stick to SemVer as good as you can. Maybe the following table can help:
</p><div><table style="border-collapse:collapse" border="0"><colgroup><col style="width:75px"/><col style="width:75px"/><col style="width:254px"/><col style="width:361px"/></colgroup><tbody valign="top"><tr style="height: 25px"><td vAlign="middle" style="background: #0188b5; padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  solid black 1.0pt"><p style="text-align: center"><span style="color:white; font-size:12pt"><strong>SemVer</strong></span></p></td><td vAlign="middle" style="background: #0188b5; padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  none"><p style="text-align: center"><span style="color:white; font-size:12pt"><strong>NuGet</strong></span></p></td><td colspan="2" vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  none"> </td></tr><tr style="height: 25px"><td vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  solid black 1.0pt"><p style="text-align: center"><strong>v</strong></p></td><td vAlign="middle" style="background: #e2001a; padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  solid black 1.0pt"><p style="text-align: center"><strong>x</strong></p></td><td vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  solid black 1.0pt"><p>  SemVer Versioning Scheme</p></td><td vAlign="middle" style="background: #e2001a; padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  none"><p>  major.minor.patch[-prerelease][+build]</p></td></tr><tr style="height: 25px"><td vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  solid black 1.0pt"><p style="text-align: center"><strong>v</strong></p></td><td vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  solid black 1.0pt"><p style="text-align: center"><strong>v</strong></p></td><td vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  solid black 1.0pt"><p>  NuGet pre-release package</p></td><td vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  none"><p>  major.minor.patch-prerelease</p></td></tr><tr style="height: 25px"><td vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  solid black 1.0pt"><p style="text-align: center"><strong>v</strong></p></td><td vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  solid black 1.0pt"><p style="text-align: center"><strong>v</strong></p></td><td vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  solid black 1.0pt"><p>  NuGet release package</p></td><td vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  solid black 1.0pt; border-right:  none"><p>  major.minor.patch</p></td></tr><tr style="height: 42px"><td vAlign="middle" style="background: #e2001a; padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  none; border-right:  solid black 1.0pt"><p style="text-align: center"><strong>x</strong></p></td><td vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  none; border-right:  solid black 1.0pt"><p style="text-align: center"><strong>v</strong></p></td><td vAlign="middle" style="padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  none; border-right:  solid black 1.0pt"><p>  Legacy Versioning Scheme</p></td><td vAlign="middle" style="background: #e2001a; padding-top: 3px; padding-left: 3px; padding-bottom: 3px; padding-right: 3px; border-top:  none; border-left:  none; border-bottom:  none; border-right:  none"><p>  major.minor.build.revision</p></td></tr></tbody></table></div><p>Basically, it comes down to this:
</p><ul><li>Avoid 3 dots in your package version
</li><li>Avoid build numbers in your package version (unless you use the leading-zeros-prerelease-suffix trick, e.g. 1.0.0-alpha0001 – as explained in my MSDN Article "<a href="http://msdn.microsoft.com/en-us/magazine/jj851071.aspx">Top 10 NuGet (anti-)patterns</a>")
</li></ul><p>The NuGet Package Analysis <a href="https://github.com/xavierdecoster/NuGet.PackageAnalysis">SemanticVersionRule extension</a> I built might help you in avoiding this trap. Good luck!</p></p>
